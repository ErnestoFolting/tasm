Turbo Assembler	 Version 2.51	     01/06/22 21:13:58	    Page 1
4m.asm



      1					 FINDMAX MACRO
      2					 LOCAL MAX, NOTBIGGER
      3					 MOV AX, MAS[SI]
      4					 MOV MAXEL, AX
      5					 MAX:
      6					 MOV DX, MAS[SI]
      7					 CMP DX, MAXEL
      8					 JLE NOTBIGGER
      9					 MOV MAXEL, DX
     10					 NOTBIGGER:
     11					 ADD SI, 2
     12					 LOOP MAX
     13					 ENDM
     14
     15	    0000			 STSEG SEGMENT PARA STACK "STACK"
     16	    0000  40*(53 54 41 43 4B)	 DB 64 DUP("STACK")
     17	    0140			 STSEG ENDS
     18
     19	    0000			 DSEG SEGMENT PARA PUBLIC "DATA"
     20	    0000  48 49	2C 20 49 4E 50+	 STARTMESSAGE DB 'HI, INPUT ARRAY SIZE FROM 1 T0 10 $'
     21		  55 54	20 41 52 52 41+
     22		  59 20	53 49 5A 45 20+
     23		  46 52	4F 4D 20 31 20+
     24		  54 30	20 31 30 20 24
     25	    0023  4F 4F	4F 50 53 2C 20+	 ERRORMESSAGE DB 'OOOPS, WRONG DATA, ONLY FROM -32768 to 32767$'
     26		  57 52	4F 4E 47 20 44+
     27		  41 54	41 2C 20 4F 4E+
     28		  4C 59	20 46 52 4F 4D+
     29		  20 2D	33 32 37 36 38+
     30		  20 74	6F 20 33 32 37+
     31		  36 37	24
     32	    0050  59 4F	55 52 20 53 54+	 MASMESSAGE DB 'YOUR START ARRAY: $'
     33		  41 52	54 20 41 52 52+
     34		  41 59	3A 20 24
     35	    0063  49 4E	50 55 54 20 59+	 INPUTMASMESSAGE DB 'INPUT YOUR	ELEMENTS WITH PRESSING ENTER, BY DEFAULT 0: $'
     36		  4F 55	52 20 45 4C 45+
     37		  4D 45	4E 54 53 20 57+
     38		  49 54	48 20 50 52 45+
     39		  53 53	49 4E 47 20 45+
     40		  4E 54	45 52 2C 20 42+
     41		  59 20	44 45 46 41 55+
     42		  4C 54	20 30 3A 20 24
     43	    009B  4F 56	45 52 46 4C 4F+	 SUMOVERFLOWMESSAGE DB 'OVERFLOW WHILE SUM $'
     44		  57 20	57 48 49 4C 45+
     45		  20 53	55 4D 20 24
     46	    00AF  54 48	45 20 53 55 4D+	 SUMMESSAGE DB 'THE SUMM OF ELEMENTS: $'
     47		  4D 20	4F 46 20 45 4C+
     48		  45 4D	45 4E 54 53 3A+
     49		  20 24
     50	    00C6  54 48	45 20 4D 41 58+	 MAXMESSAGE DB 'THE MAX	ELEMENT: $'
     51		  20 45	4C 45 4D 45 4E+
     52		  54 3A	20 24
     53	    00D8  53 4F	52 54 45 44 20+	 SORTMESSAGE DB	'SORTED	ARRAY: $'
     54		  41 52	52 41 59 3A 20+
     55		  24
     56	    00E7  49 4E	43 4F 52 52 45+	 SIZEERRORMESSAGE DB 'INCORRECT	SIZE OF	ARRAY $'
     57		  43 54	20 53 49 5A 45+
Turbo Assembler	 Version 2.51	     01/06/22 21:13:58	    Page 2
4m.asm



     58		  20 4F	46 20 41 52 52+
     59		  41 59	20 24
     60
     61	    0100  07 ??	07*(0A)		 NUMBERSTR DB 7,?,7 DUP(0AH)
     62
     63	    0109  0A*(0000)		 MAS DW	10 DUP(0)
     64
     65	    011D  0000			 NUMBER	DW 0
     66	    011F  0000			 TEMPCX	DW 0
     67	    0121  0000			 TEMPSI	DW 0
     68	    0123  0000			 NUMBERELEMENTS	DW 0
     69	    0125  0000			 SUM DW	0
     70	    0127  0000			 MAXEL DW 0
     71	    0129  0000			 I DW 0
     72	    012B  0000			 J DW 0
     73	    012D  0000			 SUMOVERFLOW DW	0
     74	    012F  0000			 INPUTOVERFLOW DW 0
     75
     76	    0131  0000			 NUMBERTOPRINT DW 0
     77
     78	    0133  0001			 CONVERTATIONCORRECT DW	1
     79
     80
     81		  = -8000		 MINNUM	EQU -32768
     82		  = 0000		 TOCOMP	EQU 0
     83
     84	    0135			 DSEG ENDS
     85
     86	    0000			 CSEG SEGMENT PARA PUBLIC "CODE"
     87					 .386
     88
     89					 ASSUME	CS:CSEG, DS:DSEG, SS:STSEG
     90
     91	    0000			 MAIN PROC FAR
     92
     93	    0000  1E			 PUSH DS
     94	    0001  33 C0			 XOR AX,AX
     95	    0003  50			 PUSH AX
     96					 ;INITIALIZATION OF DS
     97	    0004  B8 0000s		 MOV AX,DSEG
     98	    0007  8E D8			 MOV DS,AX
     99
    100	    0009  BA 0000r		 LEA DX, STARTMESSAGE
    101	    000C  B4 09			 MOV AH,9H
    102	    000E  CD 21			 INT 21H
    103
    104					 ;INPUT	SIZE
    105	    0010  B4 0A			 MOV AH, 0AH
    106	    0012  BA 0100r		 LEA DX, NUMBERSTR
    107	    0015  CD 21			 INT 21H
    108	    0017  E8 019F		 CALL PRINTNEWLINE
    109
    110					 ;CONVERTATION OF INPUT	SIZE
    111	    001A  E8 01B0		 CALL CONVERTATION
    112	    001D  83 3E	0133r 01	 CMP CONVERTATIONCORRECT, 1
    113	    0022  0F 85	00BF		 JNE INCORRECTSIZE
    114	    0026  83 3E	011Dr 00	 CMP NUMBER, 0
Turbo Assembler	 Version 2.51	     01/06/22 21:13:58	    Page 3
4m.asm



    115	    002B  0F 8E	00B6		 JLE INCORRECTSIZE
    116					 ;COMPARE WITH MAX SIZE
    117	    002F  B8 000B		 MOV AX, 11
    118	    0032  3B 06	011Dr		 CMP AX, NUMBER
    119	    0036  0F 8E	00AB		 JLE INCORRECTSIZE
    120	    003A  8B 0E	011Dr		 MOV CX, NUMBER
    121	    003E  89 0E	0123r		 MOV NUMBERELEMENTS, CX
    122	    0042  BE 0000		 MOV SI, 0
    123	    0045  E8 00A9		 CALL INPUTMAS
    124	    0048  83 3E	012Fr 01	 CMP INPUTOVERFLOW, 1
    125	    004D  0F 84	009F		 JE INCORRECT
    126	    0051  BE 0000		 MOV SI, 0
    127	    0054  8B 0E	0123r		 MOV CX, NUMBERELEMENTS
    128	    0058  BA 0050r		 LEA DX, MASMESSAGE
    129	    005B  B4 09			 MOV AH, 9H
    130	    005D  CD 21			 INT 21H
    131	    005F  E8 0157		 CALL PRINTNEWLINE
    132	    0062  E8 00D0		 CALL PRINTMAS
    133	    0065  BE 0000		 MOV SI, 0
    134	    0068  8B 0E	0123r		 MOV CX, NUMBERELEMENTS
    135	    006C  E8 00E3		 CALL FINDSUM
    136	    006F  83 3E	012Dr 00	 CMP SUMOVERFLOW, 0
    137	    0074  75 7A	90 90		 JNE INCORRECT
    138	    0078  A1 0125r		 MOV AX, SUM
    139	    007B  A3 0131r		 MOV NUMBERTOPRINT, AX
    140	    007E  E8 0138		 CALL PRINTNEWLINE
    141	    0081  BA 00AFr		 LEA DX, SUMMESSAGE
    142	    0084  B4 09			 MOV AH, 9H
    143	    0086  CD 21			 INT 21H
    144	    0088  E8 012E		 CALL PRINTNEWLINE
    145	    008B  E8 019D		 CALL PRINTNUMBER
    146	    008E  BE 0000		 MOV SI, 0
    147	    0091  8B 0E	0123r		 MOV CX, NUMBERELEMENTS
    148					 FINDMAX
1   149	    0095  8B 84	0109r		 MOV AX, MAS[SI]
1   150	    0099  A3 0127r		 MOV MAXEL, AX
1   151	    009C			 ??0000:
1   152	    009C  8B 94	0109r		 MOV DX, MAS[SI]
1   153	    00A0  3B 16	0127r		 CMP DX, MAXEL
1   154	    00A4  7E 06	90 90		 JLE ??0001
1   155	    00A8  89 16	0127r		 MOV MAXEL, DX
1   156	    00AC			 ??0001:
1   157	    00AC  83 C6	02		 ADD SI, 2
1   158	    00AF  E2 EB			 LOOP ??0000
    159	    00B1  A1 0127r		 MOV AX, MAXEL
    160	    00B4  A3 0131r		 MOV NUMBERTOPRINT, AX
    161	    00B7  E8 00FF		 CALL PRINTNEWLINE
    162	    00BA  BA 00C6r		 LEA DX, MAXMESSAGE
    163	    00BD  B4 09			 MOV AH, 9H
    164	    00BF  CD 21			 INT 21H
    165	    00C1  E8 00F5		 CALL PRINTNEWLINE
    166	    00C4  E8 0164		 CALL PRINTNUMBER
    167	    00C7  BE 0000		 MOV SI, 0
    168	    00CA  E8 00A8		 CALL SORTMAS
    169	    00CD  E8 00E9		 CALL PRINTNEWLINE
    170	    00D0  BA 00D8r		 LEA DX, SORTMESSAGE
    171	    00D3  B4 09			 MOV AH, 9H
Turbo Assembler	 Version 2.51	     01/06/22 21:13:58	    Page 4
4m.asm



    172	    00D5  CD 21			 INT 21H
    173	    00D7  BE 0000		 MOV SI, 0
    174	    00DA  8B 0E	0123r		 MOV CX, NUMBERELEMENTS
    175	    00DE  E8 00D8		 CALL PRINTNEWLINE
    176	    00E1  E8 0051		 CALL PRINTMAS
    177
    178	    00E4  CB			 RET
    179	    00E5			 INCORRECTSIZE:
    180	    00E5  E8 00D1		 CALL PRINTNEWLINE
    181	    00E8  BA 00E7r		 LEA DX, SIZEERRORMESSAGE
    182	    00EB  B4 09			 MOV AH,9H
    183	    00ED  CD 21			 INT 21H
    184	    00EF  CB			 RET
    185	    00F0			 INCORRECT:
    186	    00F0  CB			 RET
    187
    188	    00F1			 MAIN ENDP
    189
    190					 ;INPUT	ARRAY BY USER
    191	    00F1			 INPUTMAS PROC NEAR
    192	    00F1  BA 0063r		 LEA DX, INPUTMASMESSAGE
    193	    00F4  B4 09			 MOV AH, 9H
    194	    00F6  CD 21			 INT 21H
    195	    00F8  E8 00BE		 CALL PRINTNEWLINE
    196	    00FB			 INPUTEL:
    197	    00FB  89 0E	011Fr		 MOV TEMPCX, CX
    198	    00FF  B4 0A			 MOV AH, 0AH
    199	    0101  BA 0100r		 LEA DX, NUMBERSTR
    200	    0104  CD 21			 INT 21H
    201	    0106  89 36	0121r		 MOV TEMPSI, SI
    202	    010A  E8 00AC		 CALL PRINTNEWLINE
    203	    010D  E8 00BD		 CALL CONVERTATION
    204	    0110  8B 36	0121r		 MOV SI, TEMPSI
    205	    0114  83 3E	0133r 01	 CMP CONVERTATIONCORRECT, 1
    206	    0119  75 13	90 90		 JNE INCORRECTINPUT
    207	    011D  A1 011Dr		 MOV AX, NUMBER
    208	    0120  89 84	0109r		 MOV MAS[SI], AX
    209	    0124  8B 0E	011Fr		 MOV CX, TEMPCX
    210	    0128  83 C6	02		 ADD SI, 2
    211	    012B  E2 CE			 LOOP INPUTEL
    212	    012D  C3			 RET
    213	    012E			 INCORRECTINPUT:
    214	    012E  C7 06	012Fr 0001	 MOV INPUTOVERFLOW, 1
    215	    0134  C3			 RET
    216	    0135			 INPUTMAS ENDP
    217
    218	    0135			 PRINTMAS PROC NEAR
    219	    0135			 PRINTEL:
    220	    0135  89 0E	011Fr		 MOV TEMPCX, CX
    221	    0139  8B 94	0109r		 MOV DX, MAS[SI]
    222	    013D  89 16	0131r		 MOV NUMBERTOPRINT, DX
    223	    0141  E8 00E7		 CALL PRINTNUMBER
    224	    0144  B0 20			 MOV AL, ' '
    225	    0146  CD 29			 INT 29H
    226	    0148  83 C6	02		 ADD SI, 2
    227	    014B  8B 0E	011Fr		 MOV CX, TEMPCX
    228	    014F  E2 E4			 LOOP PRINTEL
Turbo Assembler	 Version 2.51	     01/06/22 21:13:58	    Page 5
4m.asm



    229	    0151  C3			 RET
    230	    0152			 PRINTMAS ENDP
    231
    232
    233	    0152			 FINDSUM PROC NEAR
    234	    0152			 SUMMA:
    235	    0152  8B 94	0109r		 MOV DX, MAS[SI]
    236	    0156  01 16	0125r		 ADD SUM, DX
    237	    015A  70 08	90 90		 JO OF
    238	    015E  83 C6	02		 ADD SI, 2
    239	    0161  E2 EF			 LOOP SUMMA
    240	    0163  C3			 RET
    241	    0164			 OF:
    242	    0164  E8 0052		 CALL PRINTNEWLINE
    243	    0167  BA 009Br		 LEA DX, SUMOVERFLOWMESSAGE
    244	    016A  B4 09			 MOV AH,9H
    245	    016C  CD 21			 INT 21H
    246	    016E  C7 06	012Dr 0001	 MOV SUMOVERFLOW, 1
    247	    0174  C3			 RET
    248	    0175			 FINDSUM ENDP
    249
    250	    0175			 SORTMAS PROC NEAR
    251	    0175  83 3E	0123r 01	 CMP NUMBERELEMENTS, 1
    252	    017A  74 3C	90 90		 JE ELEMENT
    253	    017E  A1 0123r		 MOV AX, NUMBERELEMENTS
    254	    0181  A3 0129r		 MOV I,	AX
    255	    0184  48			 DEC AX
    256	    0185  A3 012Br		 MOV J,	AX
    257	    0188  8B 0E	0129r		 MOV CX, I
    258	    018C			 EXTERNAL:
    259
    260	    018C  89 0E	011Fr		 MOV TEMPCX, CX
    261	    0190  8B 0E	012Br		 MOV CX, J
    262	    0194			 INTERNAL:
    263	    0194  8B 84	0109r		 MOV AX, MAS[SI]
    264	    0198  8B 9C	010Br		 MOV BX, MAS[SI+2]
    265	    019C  3B C3			 CMP AX, BX
    266	    019E  7E 0A	90 90		 JLE LOWER
    267	    01A2  89 9C	0109r		 MOV MAS[SI], BX
    268	    01A6  89 84	010Br		 MOV MAS[SI+2],	AX
    269	    01AA			 LOWER:
    270	    01AA  83 C6	02		 ADD SI, 2
    271	    01AD  E2 E5			 LOOP INTERNAL
    272	    01AF  BE 0000		 MOV SI, 0
    273	    01B2  8B 0E	011Fr		 MOV CX, TEMPCX
    274
    275	    01B6  E2 D4			 LOOP EXTERNAL
    276	    01B8			 ELEMENT:
    277	    01B8  C3			 RET
    278	    01B9			 SORTMAS ENDP
    279
    280
    281	    01B9			 PRINTNEWLINE PROC NEAR
    282	    01B9  B0 0A			 MOV AL, 0AH
    283	    01BB  CD 29			 INT 29H
    284	    01BD  B0 0D			 MOV AL, 13
    285	    01BF  CD 29			 INT 29H
Turbo Assembler	 Version 2.51	     01/06/22 21:13:58	    Page 6
4m.asm



    286	    01C1  C3			 RET
    287	    01C2			 PRINTNEWLINE ENDP
    288
    289	    01C2			 PRINTERROR PROC NEAR
    290	    01C2  BA 0023r		 LEA DX, ERRORMESSAGE
    291	    01C5  B4 09			 MOV AH, 9H
    292	    01C7  CD 21			 INT 21H
    293	    01C9  E8 FFED		 CALL PRINTNEWLINE
    294	    01CC  C3			 RET
    295	    01CD			 PRINTERROR ENDP
    296
    297	    01CD			 CONVERTATION PROC NEAR
    298					 ;CONVERT TO NUMBER
    299	    01CD  BE 0102r		 LEA SI, NUMBERSTR +2
    300	    01D0  80 3C	2D		 CMP BYTE PTR [SI], "-"
    301	    01D3  75 03	90 90		 JNE A1
    302	    01D7  46			 INC SI
    303
    304	    01D8			 A1:
    305	    01D8  33 C0			 XOR AX,AX
    306	    01DA  BB 000A		 MOV BX,10
    307
    308	    01DD			 A2:
    309	    01DD  8A 0C			 MOV CL, [SI]
    310	    01DF  80 F9	0D		 CMP CL, 0DH
    311	    01E2  74 38	90 90		 JZ NEGATIVE
    312
    313	    01E6  80 F9	30		 CMP CL,'0'
    314	    01E9  72 1B	90 90		 JB ERROR
    315	    01ED  80 F9	39		 CMP CL, '9'
    316	    01F0  77 14	90 90		 JA ERROR
    317
    318	    01F4  80 E9	30		 SUB CL, '0'
    319	    01F7  F7 EB			 IMUL BX
    320	    01F9  70 0B	90 90		 JO ERROR
    321	    01FD  03 C1			 ADD AX, CX
    322	    01FF  70 0F	90 90		 JO MIN
    323	    0203  46			 INC SI
    324	    0204  EB D7			 JMP A2
    325	    0206			 ERROR:
    326	    0206  E8 FFB9		 CALL PRINTERROR
    327	    0209  C7 06	0133r 0000	 MOV CONVERTATIONCORRECT, 0
    328	    020F  C3			 RET
    329	    0210			 MIN:
    330	    0210  3D 8000		 CMP AX, MINNUM
    331	    0213  75 F1			 JNE ERROR
    332	    0215  80 3E	0102r 2D	 CMP BYTE PTR [NUMBERSTR + 2], "-"
    333	    021A  75 EA			 JNE ERROR
    334	    021C			 NEGATIVE:
    335	    021C  80 3E	0102r 2D	 CMP BYTE PTR [NUMBERSTR + 2], "-"
    336	    0221  75 04	90 90		 JNE A3
    337	    0225  F7 D8			 NEG AX
    338	    0227			 A3:
    339	    0227  A3 011Dr		 MOV NUMBER,AX
    340	    022A  C3			 RET
    341	    022B			 CONVERTATION ENDP
    342
Turbo Assembler	 Version 2.51	     01/06/22 21:13:58	    Page 7
4m.asm



    343
    344
    345
    346	    022B			 PRINTNUMBER PROC NEAR
    347	    022B  8B 1E	0131r		 MOV BX, NUMBERTOPRINT
    348	    022F  0B DB			 OR BX,BX
    349	    0231  79 08	90 90		 JNS M1
    350	    0235  B0 2D			 MOV AL, '-'
    351	    0237  CD 29			 INT 29H
    352	    0239  F7 DB			 NEG BX
    353
    354	    023B			 M1:
    355	    023B  8B C3			 MOV AX,BX
    356	    023D  33 C9			 XOR CX, CX
    357	    023F  BB 000A		 MOV BX, 10
    358
    359	    0242			 M2:
    360	    0242  33 D2			 XOR DX,DX
    361	    0244  F7 F3			 DIV BX
    362	    0246  80 C2	30		 ADD DL, '0'
    363	    0249  52			 PUSH DX
    364	    024A  41			 INC CX
    365	    024B  85 C0			 TEST AX,AX
    366	    024D  75 F3			 JNZ M2
    367
    368	    024F			 M3:
    369	    024F  58			 POP AX
    370	    0250  CD 29			 INT 29H
    371	    0252  E2 FB			 LOOP M3
    372	    0254  C3			 RET
    373	    0255			 PRINTNUMBER ENDP
    374
    375
    376	    0255			 CSEG ENDS
    377					 END MAIN
Turbo Assembler	 Version 2.51	     01/06/22 21:13:58	    Page 8
Symbol Table




Symbol Name			  Type	 Value

??0000				  Near	 CSEG:009C
??0001				  Near	 CSEG:00AC
??DATE				  Text	 "01/06/22"
??FILENAME			  Text	 "4m	  "
??TIME				  Text	 "21:13:58"
??VERSION			  Number 0205
@CPU				  Text	 0D0FH
@CURSEG				  Text	 CSEG
@FILENAME			  Text	 4M
@WORDSIZE			  Text	 4
A1				  Near	 CSEG:01D8
A2				  Near	 CSEG:01DD
A3				  Near	 CSEG:0227
CONVERTATION			  Near	 CSEG:01CD
CONVERTATIONCORRECT		  Word	 DSEG:0133
ELEMENT				  Near	 CSEG:01B8
ERROR				  Near	 CSEG:0206
ERRORMESSAGE			  Byte	 DSEG:0023
EXTERNAL			  Near	 CSEG:018C
FINDSUM				  Near	 CSEG:0152
I				  Word	 DSEG:0129
INCORRECT			  Near	 CSEG:00F0
INCORRECTINPUT			  Near	 CSEG:012E
INCORRECTSIZE			  Near	 CSEG:00E5
INPUTEL				  Near	 CSEG:00FB
INPUTMAS			  Near	 CSEG:00F1
INPUTMASMESSAGE			  Byte	 DSEG:0063
INPUTOVERFLOW			  Word	 DSEG:012F
INTERNAL			  Near	 CSEG:0194
J				  Word	 DSEG:012B
LOWER				  Near	 CSEG:01AA
M1				  Near	 CSEG:023B
M2				  Near	 CSEG:0242
M3				  Near	 CSEG:024F
MAIN				  Far	 CSEG:0000
MAS				  Word	 DSEG:0109
MASMESSAGE			  Byte	 DSEG:0050
MAXEL				  Word	 DSEG:0127
MAXMESSAGE			  Byte	 DSEG:00C6
MIN				  Near	 CSEG:0210
MINNUM				  Number -8000
NEGATIVE			  Near	 CSEG:021C
NUMBER				  Word	 DSEG:011D
NUMBERELEMENTS			  Word	 DSEG:0123
NUMBERSTR			  Byte	 DSEG:0100
NUMBERTOPRINT			  Word	 DSEG:0131
OF				  Near	 CSEG:0164
PRINTEL				  Near	 CSEG:0135
PRINTERROR			  Near	 CSEG:01C2
PRINTMAS			  Near	 CSEG:0135
PRINTNEWLINE			  Near	 CSEG:01B9
PRINTNUMBER			  Near	 CSEG:022B
SIZEERRORMESSAGE		  Byte	 DSEG:00E7
SORTMAS				  Near	 CSEG:0175
Turbo Assembler	 Version 2.51	     01/06/22 21:13:58	    Page 9
Symbol Table



SORTMESSAGE			  Byte	 DSEG:00D8
STARTMESSAGE			  Byte	 DSEG:0000
SUM				  Word	 DSEG:0125
SUMMA				  Near	 CSEG:0152
SUMMESSAGE			  Byte	 DSEG:00AF
SUMOVERFLOW			  Word	 DSEG:012D
SUMOVERFLOWMESSAGE		  Byte	 DSEG:009B
TEMPCX				  Word	 DSEG:011F
TEMPSI				  Word	 DSEG:0121
TOCOMP				  Number 0000

Macro Name

FINDMAX

Groups & Segments		  Bit Size Align  Combine Class

CSEG				  16  0255 Para	  Public  CODE
DSEG				  16  0135 Para	  Public  DATA
STSEG				  16  0140 Para	  Stack	  STACK
